================================================================================
  Licensed to the Apache Software Foundation (ASF) under one or more
  contributor license agreements.  See the NOTICE file distributed with
  this work for additional information regarding copyright ownership.
  The ASF licenses this file to You under the Apache License, Version 2.0
  (the "License"); you may not use this file except in compliance with
  the License.  You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

  Unless required by applicable law or agreed to in writing, software
  distributed under the License is distributed on an "AS IS" BASIS,
  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  See the License for the specific language governing permissions and
  limitations under the License.
================================================================================

$Id$

                         =================================
                         Apache Tomcat 6.0 Patch Proposals
                         =================================


RELEASE SHOWSTOPPERS:


PATCHES ACCEPTED TO BACKPORT:
  [ start all new proposals below, under PATCHES PROPOSED. ]


PATCHES PROPOSED TO BACKPORT:
  [ New proposals should be added at the end of the list ]

* Backport cleanup of semantics of thisAccessedTime and
  lastAccessedTime for sessions:
  - preparational whitespace changes
    http://svn.apache.org/viewvc?rev=711695&view=rev
  - Give thisAccessedTime and lastAccessedTime for sessions
    a clear semantics:
    http://svn.apache.org/viewvc?rev=711711&view=rev
    - thisAccessedTime will be updated at the beginning and
      at the end of session use
    - lastAccessedTime will only be updated at the end of
      session use
    This means:
    - lastAccessedTime is the last access time of a session
      disregarding any request still being processed on.
      So this is good to use even from within a request
      to detect when its own session has been used last before.
    - thisAccessedTime already gets updated when a new request
      disregarding any request still being processed on.
      So this is better for any idleness check or information.
    - thisAccessedTime >= lastAccessedTime always
  - Port from StandardSession to DeltaSession
    http://svn.apache.org/viewvc?rev=711714&view=rev
  - Expose thisAccessedTime via the session interface
    and ManagerBase, so we can use it from outside the session.
    http://svn.apache.org/viewvc?rev=711716&view=rev
  - Make the classes checking session idleness use thisAccessedTime.
    http://svn.apache.org/viewvc?rev=711720&view=rev
    This is not for invalidation, only for displaying
    idle times and making persistance decisions.
  +1: rjung
   0: billbarker: generally agree with remm that this is too big of a change for the stable branch
                 but could agree to some of it if it was split into parts
   0: markt: Agree with Bill - smaller parts would be better
  -1: remm: no for TC 6.0
  -1: funkman : api change in Session.java for .x.x release

* Fix the maven stuff for the maven repo.
  Before it does't find tomcat-juli.jar and the remoteRepository seems broken .
  http://people.apache.org/~jfclere/patches/maven.patch
  +1: jfclere
  -1: fhanik - easier to pass in the root path (lib/bin) to the macro instead of hacking around it
               if we remove the SCP auto feature, then there should be something to replace it with
               (http://ant.apache.org/manual/OptionalTasks/scp.html)  

* Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=48545
  Truststores don't have to have passwords
  Based on a patch by 'smmwpf54'
  http://svn.apache.org/viewvc?view=revision&revision=910266
  +1: markt
  -1: jfclere: Doc says it should use keystorePass (http://tomcat.apache.org/tomcat-6.0-doc/config/http.html).
               so that would break existing configurations.
      markt: It shouldn't break existing configs. JSSE allows trust stores to be
             read without providing the password

* Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=48589
  Make JNDIRealm easier to extend
  Based on a patch by Candid Dauth
  http://svn.apache.org/viewvc?rev=910485&view=rev
  http://svn.apache.org/viewvc?rev=918489&view=rev (review feedback)
  +1: markt, kkolinko
  -1: 

  Additional patch:
  http://svn.apache.org/viewvc?rev=918803&view=rev
  +1: kkolinko, markt
  -1:

* Improve logging behaviour when shutdown occurs via a shutdownhook. If present,
  use Catalina's shutdown hook to shutdown Tomcat and JULI. This enables them to
  be shutdown in the correct order. 
  http://svn.apache.org/viewvc?rev=910974&view=rev
  http://svn.apache.org/viewvc?rev=918594&view=rev (review feedback BZ48831)
  +1: markt
  +1: kkolinko: with the additional patches proposed below
  -1: 

  Additional patches:
  http://svn.apache.org/viewvc?rev=918792&view=rev (FileHandler: whitespace)
  http://svn.apache.org/viewvc?rev=918799&view=rev (FileHandler: try/finally)
  http://svn.apache.org/viewvc?rev=918787&view=rev (ClassLoaderLogManager: fix BZ48831)
  http://svn.apache.org/viewvc?rev=918885&view=rev (ignore reset call from j.u.l.LogManager.Cleaner)

  here is the combined patch file
  (revisions 910974,918594,918792,918799,918787,918885):
  http://people.apache.org/~kkolinko/patches/2010-03-04_tc6_bug48831.patch
  +1: kkolinko, markt, rjung
  -1:

* Replace UTF-8 characters with the proper \uxxxx encoding in the French translation.
  That prevents deployment of applications when using french language.
+++
Index: java/org/apache/catalina/session/LocalStrings_fr.properties
===================================================================
--- java/org/apache/catalina/session/LocalStrings_fr.properties	(revision 919592)
+++ java/org/apache/catalina/session/LocalStrings_fr.properties	(working copy)
@@ -67,13 +67,13 @@
 standardSession.setAttribute.namenull="setAttribute": le nom de param\u00e8tre ne peut \u00eatre nul
 persistentManager.unloading=Sauvegarde de {0} sessions persistantes
 persistentManager.expiring=Expiration de {0} sessions avant leur sauvegarde
-persistentManager.deserializeError=Erreur lors de la désérialisation de la session {0}: {1}
-persistentManager.serializeError=Erreur lors de la sérialisation de la session {0}: {1}
+persistentManager.deserializeError=Erreur lors de la d\u00e9s\u00e9rialisation de la session {0}: {1}
+persistentManager.serializeError=Erreur lors de la s\u00e9rialisation de la session {0}: {1}
 persistentManager.swapMaxIdle=Basculement de la session {0} vers le stockage (Store), en attente pour {1} secondes
 persistentManager.backupMaxIdle=Sauvegarde de la session {0} vers le stockage (Store), en attente pour {1} secondes
 persistentManager.backupException=Exception lors de la sauvegarde de la session {0}: {1}
-persistentManager.tooManyActive=Trop de sessions actives, {0}, à la recherche de sessions en attente pour basculement vers stockage (swap out)
+persistentManager.tooManyActive=Trop de sessions actives, {0}, \u00e0 la recherche de sessions en attente pour basculement vers stockage (swap out)
 persistentManager.swapTooManyActive=Basculement vers stockage (swap out) de la session {0}, en attente pour {1} secondes trop de sessions actives
-persistentManager.processSwaps=Recherche de sessions à basculer vers stockage (swap out), {0} sessions actives en mémoire
-persistentManager.activeSession=La session {0} a été en attente durant {1} secondes
+persistentManager.processSwaps=Recherche de sessions \u00e0 basculer vers stockage (swap out), {0} sessions actives en m\u00e9moire
+persistentManager.activeSession=La session {0} a \u00e9t\u00e9 en attente durant {1} secondes
 persistentManager.swapIn=Basculement depuis le stockage (swap in) de la session {0}
Index: webapps/examples/WEB-INF/classes/LocalStrings_fr.properties
===================================================================
--- webapps/examples/WEB-INF/classes/LocalStrings_fr.properties	(revision 919592)
+++ webapps/examples/WEB-INF/classes/LocalStrings_fr.properties	(working copy)
@@ -20,34 +20,34 @@
 
 helloworld.title=Salut le Monde!
 
-requestinfo.title=Exemple d''information sur la requête
-requestinfo.label.method=Méthode:
-requestinfo.label.requesturi=URI de requête:
+requestinfo.title=Exemple d''information sur la requ\u00eate
+requestinfo.label.method=M\u00e9thode:
+requestinfo.label.requesturi=URI de requ\u00eate:
 requestinfo.label.protocol=Protocole:
 requestinfo.label.pathinfo=Info de chemin:
 requestinfo.label.remoteaddr=Adresse distante:
 
-requestheader.title=Exemple d''information sur les entête de requête
+requestheader.title=Exemple d''information sur les ent\u00eate de requ\u00eate
 
-requestparams.title=Exemple de requête avec paramêtres
-requestparams.params-in-req=Paramêtres dans la requête:
-requestparams.no-params=Pas de paramêtre, merci dans saisir quelqu'uns
-requestparams.firstname=Prénom:
+requestparams.title=Exemple de requ\u00eate avec param\u00eatres
+requestparams.params-in-req=Param\u00eatres dans la requ\u00eate:
+requestparams.no-params=Pas de param\u00eatre, merci dans saisir quelqu'uns
+requestparams.firstname=Pr\u00e9nom:
 requestparams.lastname=Nom:
 
 cookies.title=Exemple d''utilisation de Cookies
 cookies.cookies=Votre navigateur retourne les cookies suivant:
 cookies.no-cookies=Votre navigateur ne retourne aucun cookie
-cookies.make-cookie=Création d''un cookie à retourner à votre navigateur
+cookies.make-cookie=Cr\u00e9ation d''un cookie \u00e0 retourner \u00e0 votre navigateur
 cookies.name=Nom:
 cookies.value=Valeur:
-cookies.set=Vous venez d''envoyer le cookie suivant à votre navigateur:
+cookies.set=Vous venez d''envoyer le cookie suivant \u00e0 votre navigateur:
 
 sessions.title=Exemple de Sessions
 sessions.id=ID de Session:
-sessions.created=Crée le:
-sessions.lastaccessed=Dernier accès:
-sessions.data=Les données existantes dans votre session:
-sessions.adddata=Ajouter des données à votre session
+sessions.created=Cr\u00e9e le:
+sessions.lastaccessed=Dernier acc\u00e8s:
+sessions.data=Les donn\u00e9es existantes dans votre session:
+sessions.adddata=Ajouter des donn\u00e9es \u00e0 votre session
 sessions.dataname=Nom de l''Attribut de Session:
 sessions.datavalue=Valeur de l''Attribut de Session:
+++
  +1: jfclere, kkolinko
  -1:
