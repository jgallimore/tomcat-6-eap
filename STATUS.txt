================================================================================
  Licensed to the Apache Software Foundation (ASF) under one or more
  contributor license agreements.  See the NOTICE file distributed with
  this work for additional information regarding copyright ownership.
  The ASF licenses this file to You under the Apache License, Version 2.0
  (the "License"); you may not use this file except in compliance with
  the License.  You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

  Unless required by applicable law or agreed to in writing, software
  distributed under the License is distributed on an "AS IS" BASIS,
  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  See the License for the specific language governing permissions and
  limitations under the License.
================================================================================

$Revision$ $Date$

                         =================================
                         Apache Tomcat 6.0 Patch Proposals
                         =================================


RELEASE SHOWSTOPPERS:


PATCHES ACCEPTED TO BACKPORT:
  [ start all new proposals below, under PATCHES PROPOSED. ]

PATCHES PROPOSED TO BACKPORT:
  [ New proposals should be added at the end of the list ]


* Add ManagerBase session getLastAccessedTimestamp and getCreationTimestamp for better
  remote JMX access.
  http://svn.apache.org/viewvc?rev=612971&view=rev
  +1: pero, rjung, fhanik, markt
  -1: remm: I believe it would need specific support for certain managers. Interested users
            could use their own extended manager instead.

* Remove old TLS code
  http://svn.apache.org/viewvc?rev=616894&view=rev
  +1: markt, fhanik
  +0: remm: I don't see the point of backporting these API changing cleanups
            (markt) This is not an API change. It is just removing the TLS code
                    that has never been included in a 6.0.x src or bin release
           It's my fault for not building it in then. I'm not sure this is intentional,
           but I am ok with the change.

* Fix http://issues.apache.org/bugzilla/show_bug.cgi?id=44282
  Do call to getClassLoader() in a privileged block.
  http://svn.apache.org/viewvc?rev=616953&view=rev
  +1: markt, fhanik
  +0: remm: do we really want to fix these sort of "bugs" ?
  -1:

* Revert back to original patch proposed for UTF8 parsing.
  This also fixes the regression for 6.0.16 and 5.5.26 (and possibly 4.1.37) mentioned in 
  http://issues.apache.org/bugzilla/show_bug.cgi?id=44494
  
  The original patch can be viewed
  http://people.apache.org/~fhanik/tomcat/b2c/patch.txt

  http://svn.apache.org/viewvc?rev=568307&view=rev
  http://svn.apache.org/viewvc?rev=568605&view=rev

  +1: fhanik
  -0: billbarker The original patch s*cks bigtime.  I agree with remy (on list) that this issue should have 
                 involved a discussion on list on how to fix, rather than just proposing a 5 sec fix.
  -1: markt This patch removes a method from a public API. With that issue fixed
            I would vote -0 until I can look at this further as explained in
            http://marc.info/?l=tomcat-dev&m=120457882215329&w=2
  -0: remm The newer code looks cleaner to me
  
* As an alternate fix to 44494, I propose this patch (bb.getLength() is equal to the
  value used as the result of available in the other proposed patch, and both  
  patches are thus using the same limit for reading data):
  Index: java/org/apache/catalina/connector/InputBuffer.java
===================================================================
--- java/org/apache/catalina/connector/InputBuffer.java	(revision 633279)
+++ java/org/apache/catalina/connector/InputBuffer.java	(working copy)
@@ -355,7 +355,7 @@
         }
 
         state = CHAR_STATE;
-        conv.convert(bb, cb, len);
+        conv.convert(bb, cb, bb.getLength());
         bb.setOffset(bb.getEnd());
 
         return cb.getLength();

  +1 : remm, markt, fhanik

* Cookie addition - due to how inconsistent browsers are we will only quote the value
  for v0 cookies.
  http://svn.apache.org/viewvc?view=rev&revision=634513
  +1: fhanik
  +0: remm
  -0: markt If the current code thinks the path needs quoting then you
            are in very uncertain territory for v0 cookies anyway and
            the chances are that something is going to break. I would
            rather keep the consistency of the quoting that might
            break a browser than have inconsistent handling of
            elements of the cookie header.
  -1:

* As an alternative to the above patch, I propose an improved patch that
  addresses the concerns with the previous alternative:
  http://people.apache.org/~markt/patches/2008-03-18-cookie-path.patch
  +1: markt
  -1:

* Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=44562
  http://svn.apache.org/viewvc?rev=635294&view=rev (prior code clean up)
  http://svn.apache.org/viewvc?rev=635297&view=rev (the actual fix)
  +1: markt, remm, jfclere
  -1:

* Fix minor HttpServlet bug. Use localised error message.
  http://svn.apache.org/viewvc?rev=635298&view=rev
  +1: markt, remm, fhanik
  -1:

* Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=44558
  http://svn.apache.org/viewvc?rev=635304&view=rev
  +1: markt, remm, jfclere
  -1:

* Add system property docs
  http://svn.apache.org/viewvc?rev=620335&view=rev
  http://svn.apache.org/viewvc/tomcat/trunk/webapps/docs/config/systemprops.xml?r1=627743&r2=627742&pathrev=627743
  +1: markt, remm, fhanik
  -1:
