================================================================================
  Licensed to the Apache Software Foundation (ASF) under one or more
  contributor license agreements.  See the NOTICE file distributed with
  this work for additional information regarding copyright ownership.
  The ASF licenses this file to You under the Apache License, Version 2.0
  (the "License"); you may not use this file except in compliance with
  the License.  You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

  Unless required by applicable law or agreed to in writing, software
  distributed under the License is distributed on an "AS IS" BASIS,
  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  See the License for the specific language governing permissions and
  limitations under the License.
================================================================================

$Id$

                         =================================
                         Apache Tomcat 6.0 Patch Proposals
                         =================================


RELEASE SHOWSTOPPERS:


PATCHES ACCEPTED TO BACKPORT:
  [ start all new proposals below, under PATCHES PROPOSED. ]

PATCHES PROPOSED TO BACKPORT:
  [ New proposals should be added at the end of the list ]

* Fix the maven stuff for the maven repo.
  Before it does't find tomcat-juli.jar and the remoteRepository seems broken .
  http://people.apache.org/~jfclere/patches/maven.patch.100711
  +1: jfclere
  -1: fhanik - easier to pass in the root path (lib/bin) to the macro instead of hacking around it
               if we remove the SCP auto feature, then there should be something to replace it with
               (http://ant.apache.org/manual/OptionalTasks/scp.html)
  +1: kkolinko: +1 for the updated patch (maven.patch.100711)
      I still think that it is not so good to remove the old code of <remoteRepository/>,
      because it ignores ${maven.repo.url} parameter provided by deploy-snapshot,
      deploy-staging and deploy-release targets. Maybe leave old code as a comment
      and fix it later if needed? I think that actually nobody besides the release manager
      uses this, so I am letting this pass.

* Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=48545
  Truststores don't have to have passwords
  Based on a patch by 'smmwpf54'
  https://issues.apache.org/bugzilla/attachment.cgi?id=26268
  +1: kkolinko, markt
  -1:

* Configure Tomcat to use HttpOnly for session cookies by default
  http://people.apache.org/~kkolinko/patches/2010-04-21_tc6_context_httpOnly.patch
  +1: kkolinko
  -0: markt - There wasn't consensus previously.
            - If you are going to change the default, do it in the code
  -1:

* Expose the new WebappLoader flag in the VirtualWebappLoader,
  but allow alternative name searchVirtualFirst to make it
  consistent with the "virtual" terminology.
  Now you can decide, whether the virtual paths will
  be searched before the webapp or after it.
  If searched before, external resources take precendence
  over internal ones. Before that change one couldn't overwrite
  resources already present in the webapp.
  http://svn.apache.org/viewvc?view=revision&revision=936825
  http://people.apache.org/~rjung/patches/2010-05-14-loader-backport-r936825.patch
  +1: rjung
  -1:
  -0: kkolinko: The patch itself is OK, but I think having a synonym will
   cause confusion. I'd prefer not to invent a new name, but mention the
   one that we already have when documenting virtualClasspath.

* Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=49555
  Correctly handle tag libraries that use functions defined in static inner
  classes
  http://svn.apache.org/viewvc?rev=961948&view=rev
  http://svn.apache.org/viewvc?rev=963106&view=rev
  http://svn.apache.org/viewvc?rev=966863&view=rev
  +1: markt, kkolinko
  -1:
   kkolinko: I was worried that ELFunctionMapper$PrivilegedGetTccl
   should be preloaded in o.a.jasper.security.SecurityClassLoad,
   but from debugging it looks that it is called by Tomcat code only
   (JspServlet).

* Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=49860
  Add support for trailing headers.
  http://svn.apache.org/viewvc?rev=1003461&view=rev
  http://svn.apache.org/viewvc?rev=1033415&view=rev
  Note: Don't change return type for parseEndChunk(), just return true.
  +1: markt
  -1:

* Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=50026
  Force DefaultServlet to serve all resources relative to context root
  regardless of mappings/mount point.
  Prevents access to WEB-INF and META-INF when the default servlet is
  mapped to a sub-path. Also fixes WebdavServlet, which is affected for GET
  requests.
  This is a breaking change for anyone re-mapping DefaultServlet to a sub-path
  (current behaviour is to remount the entire web application under the path,
  which exposes WEB-INF/META-INF).
  http://svn.apache.org/viewvc?rev=1004393&view=rev
  http://svn.apache.org/viewvc?rev=1004409&view=rev
  http://svn.apache.org/viewvc?rev=1004415&view=rev
  http://svn.apache.org/viewvc?rev=1004912&view=rev (fix for includes)
  +1: timw
  -1:
   kkolinko: See Re:r1004393 on dev@
    timw: fixed in http://svn.apache.org/viewvc?rev=1004912&view=rev

* Fix path parameter handling. Currently the following URL fails with a 404:
  http://localhost:8080/examples/jsp/snp;x=y/snoop.jsp
  http://people.apache.org/~markt/patches/2010-10-06-path-param-tc6.patch
  +1: markt
  +1: kkolinko:
    with the following trivial changes:
     - with r1022389
     - with access logging as done by r1030188
     - Mark CoyoteAdapter.parseSessionId(..) as @deprecated, because it is no more used
     - in initial assignment of 'int pathParamEnd' can s/uriBC.getStart()/start/ and s/uriBC.getEnd()/end/
     - boolean warnedEncoding = false;  I think is useless, because it is set
       to 'false' in every loop. It'd be OK to move it outside the loop.
     - Add 'coyoteAdapter.parsePathParam' message to org/apache/catalina/connector/LocalStrings.properties

   kkolinko: The old parseSessionId() method calls "clearRequestedSessionURL(request);"
     when there is no sessionid in the path. The new code does not do that. Was that
     call needed? It looks that it was not needed, but I might miss something.

   kkolinko: Discussed in Re:r1005192 thread on dev@

* Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=50140
  Don't ignore user specified installation directory on 64-bit platforms
  Allow 32-bit and 64-bit JDKs to be selected on 64-bit platforms
  http://svn.apache.org/viewvc?rev=1027504&view=rev
  +1: markt, mturk
  -1: kkolinko: The function checkJava spawns a .bat file
   (ExecWait '"$R0.bat"'). It is visible as a flickering black window
   when I go from JRE selection page to the next page in TC7 installer.
   kkolinko: merging r1027504 does not perform cleanly

* Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=50228
  Improve recycling of BodyContentImpl.
  Recycle it as early. Do not wait until it is actually reused.
  http://svn.apache.org/viewvc?rev=1032232&view=rev
  +1: kkolinko, markt
  -1:

* Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=50222
  Pin the system rather than the common class loader in memory which will
  work better in an embedded environment.
  Patch provided by Christopher Schultz.
  http://svn.apache.org/viewvc?rev=1033448&view=rev
  +1: kkolinko, markt
  -1:

