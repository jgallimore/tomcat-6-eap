================================================================================
  Licensed to the Apache Software Foundation (ASF) under one or more
  contributor license agreements.  See the NOTICE file distributed with
  this work for additional information regarding copyright ownership.
  The ASF licenses this file to You under the Apache License, Version 2.0
  (the "License"); you may not use this file except in compliance with
  the License.  You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

  Unless required by applicable law or agreed to in writing, software
  distributed under the License is distributed on an "AS IS" BASIS,
  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  See the License for the specific language governing permissions and
  limitations under the License.
================================================================================

$Revision$ $Date$

                         =================================
                         Apache Tomcat 6.0 Patch Proposals
                         =================================


RELEASE SHOWSTOPPERS:


PATCHES ACCEPTED TO BACKPORT:
  [ start all new proposals below, under PATCHES PROPOSED. ]

PATCHES PROPOSED TO BACKPORT:
  [ New proposals should be added at the end of the list ]

* Fix issue where the first request for a deleted JSPs returns as if the JSP
  still exists.
  http://svn.apache.org/viewvc?view=rev&revision=683969
  +1: markt, funkman
   0: remm (looks risky, very minor problem), fhanik - minor problem
  -1: 

* Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=45026
  Never use empty reason phrase.
  http://svn.apache.org/viewvc?rev=697183&view=rev
  +1: rjung, mturk, markt, jim
   0: remm (also affects to the two other AJP connectors)

* Allow huge request body packets for AJP13.
  This was already applied to connectors, but never
  carried forward to trunk and tc6.0.x.
  http://svn.apache.org/viewvc?rev=697192&view=rev
  Original change: http://svn.apache.org/viewvc?rev=486217&view=rev
  +1: rjung, mturk, markt, pero, jim
   0: remm (also affects to the two other AJP connectors)

* Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=45403
  See commit message for details of negligable performance impact
  http://svn.apache.org/viewvc?rev=701358&view=rev
  +1: markt, funkman
  -0: remm (I also do not think the patch is a good idea as a backport)
  -0: fhanik - the bug talks about WEB-INF/lib and reload, that would be when reload="true" which should be considered development only
      So to make this bug actually worth while fixing, and not impact performance, then it should only do this check on files that 
      are relevant to the reload of an application, in other words a watched resource

* Changes required to run with a security manager
  http://svn.apache.org/viewvc?rev=721286&view=rev (original)
  http://svn.apache.org/viewvc?rev=721704&view=rev (original)
  http://svn.apache.org/viewvc?rev=721708&view=rev (original)
  http://svn.apache.org/viewvc?rev=721886&view=rev (original)
  http://svn.apache.org/viewvc?rev=746425&view=rev (to address Bill's concerns)
  http://svn.apache.org/viewvc?rev=757335&view=rev (to remove the Catalina dep)
  +1: markt
   0: billbarker: Haven't tried to break it yet, but the 4th patch potentially
      offers access to static fields in ELContextImpl and ELResolverImpl that could 
      possibly be exploited by a malicious webapp.
  -1: billbarker: The 5th patch makes Jasper depend on Catalina, rendering Jasper useless
      to any 3rd party that just wants a JSP compiler.  Removing the Catalina dependancy
      can change my vote to +1 (although, it means trusting modern JVMs to clean up after
      themselves efficiently).

* Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=46351
  Build script re-factoring
  Patch provided by Marc Guillemot
  http://svn.apache.org/viewvc?rev=729681&view=rev
  +1: markt, jim, pero
   0: fhanik - not sure its needed in 6.0 branch if all is working with the old script
   0: funkman - ditto
  -1:

* Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=46815
  http://svn.apache.org/viewvc?rev=751289&view=rev
  http://svn.apache.org/viewvc?rev=753039&view=rev
  Make MemoryUserDatabase read-only by default
  +1: markt, rjung
  -1: 

* Use some already existing constants instead of explicit
  numbers in the AJP conectors. Backport of
  http://svn.apache.org/viewvc?rev=757706&view=rev
  +1: rjung
  -1:

* Allow huge request body packets for AJP13.
  Part 2 of the backport proposed and approved above
  (r697192), now also for the other AJP connectors.
  http://svn.apache.org/viewvc?rev=757708&view=rev
  +1: rjung
   0: remm: see below
  -1:

* Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=45026
  Never use empty reason phrase.
  Part 2 of the backport proposed and approved above
  (r697183), now also for the other AJP connectors.
  http://svn.apache.org/viewvc?rev=757721&view=rev
  +1: rjung
   0: remm
      These two fixes remind me of JBoss Web (r795 in the JBW svn), and it would be
      nice to ack that (I ack porting of all Tomcat patches, with clear attribution).
      I also think a (c) notice in the NOTICE file if porting becomes a habit (these two
      are probably not significant enough). 
      From what I know, nobody uses these two connectors in Tomcat, so it did not seem
      "port worthy" to me.
  -1:

* Backport cleanup of semantics of thisAccessedTime and
  lastAccessedTime for sessions:
  - preparational whitespace changes
    http://svn.apache.org/viewvc?rev=711695&view=rev
  - Give thisAccessedTime and lastAccessedTime for sessions
    a clear semantics:
    http://svn.apache.org/viewvc?rev=711711&view=rev
    - thisAccessedTime will be updated at the beginning and
      at the end of session use
    - lastAccessedTime will only be updated at the end of
      session use
    This means:
    - lastAccessedTime is the last access time of a session
      disregarding any request still being processed on.
      So this is good to use even from within a request
      to detect when its own session has been used last before.
    - thisAccessedTime already gets updated when a new request 
      disregarding any request still being processed on.
      So this is better for any idleness check or information.
    - thisAccessedTime >= lastAccessedTime always
  - Port from StandardSession to DeltaSession
    http://svn.apache.org/viewvc?rev=711714&view=rev
  - Expose thisAccessedTime via the session interface
    and ManagerBase, so we can use it from outside the session.
    http://svn.apache.org/viewvc?rev=711716&view=rev
  - Make the classes checking session idleness use thisAccessedTime.
    http://svn.apache.org/viewvc?rev=711720&view=rev
    This is not for invalidation, only for displaying
    idle times and making persistance decisions.
  +1: rjung
  -1:

* Fix typo in OPTIONS response
  http://svn.apache.org/viewvc?rev=757774&view=rev
  +1: markt
  -1: 

* Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=46908
  http://svn.apache.org/viewvc?rev=758365&view=rev
  Try and support java encoding names when using an xml parser provided via the
  endorsed mechanism
  +1: markt
  -1: 

* Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=46875
  http://svn.apache.org/viewvc?rev=758407&view=rev
  Catch possible ISE as a result of session expiration in comet valve
  +1: markt
  -1: 

* Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=46866
  http://svn.apache.org/viewvc?rev=758596&view=rev
  Better init of Random objects
  +1: markt
  -1: 

* Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=46822
  http://svn.apache.org/viewvc?rev=758616&view=rev
  Remove unnecessary object creation in StandardContext
  +1: markt
  -1: 

* Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=46915
  When resolving ResourceBundle properties, don't claim to have resolved the
  property unless we really have resolved it.
  http://svn.apache.org/viewvc?rev=758664&view=rev
  +1: markt
  -1: 
