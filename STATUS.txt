================================================================================
  Licensed to the Apache Software Foundation (ASF) under one or more
  contributor license agreements.  See the NOTICE file distributed with
  this work for additional information regarding copyright ownership.
  The ASF licenses this file to You under the Apache License, Version 2.0
  (the "License"); you may not use this file except in compliance with
  the License.  You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

  Unless required by applicable law or agreed to in writing, software
  distributed under the License is distributed on an "AS IS" BASIS,
  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  See the License for the specific language governing permissions and
  limitations under the License.
================================================================================

$Id$

                         =================================
                         Apache Tomcat 6.0 Patch Proposals
                         =================================


RELEASE SHOWSTOPPERS:


PATCHES ACCEPTED TO BACKPORT:
  [ start all new proposals below, under PATCHES PROPOSED. ]

PATCHES PROPOSED TO BACKPORT:
  [ New proposals should be added at the end of the list ]


* Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=55198
  Correctly escape XML output from tagx files.
  http://svn.apache.org/r1500065 (excluding tests) - original fix
  http://svn.apache.org/r1539176 (excluding tests) - required for following fix
  http://svn.apache.org/r1539177 (excluding tests) - fixes regression in original
  +1: markt, schultz
  -1:

* Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=55268
  Back-port of r1503852 from Tomcat 7.0.x.
  Add optional --service-start-wait-time command-line option to bin/daemon.sh
  to change service start wait time from default of 10 seconds.
  http://svn.apache.org/r1503852
  http://svn.apache.org/r1505844
  +1: schultz, kkolinko
  -1:

* Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=55266
  https://issues.apache.org/bugzilla/attachment.cgi?id=30608&action=diff
  Parse session ID before redirect as session ID may need to be encoded
  +1: markt, schultz, kkolinko
  -1:

* Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=52811
  Correctly parse values passed to HttpServletResponse.setContentType() to
  extract the character encoding
  Note: The original proposal that used a parser generated by javacc did not
        gather enough support for back-port.
  https://issues.apache.org/bugzilla/show_bug.cgi?id=52811
  svn cp https://svn.apache.org/repos/asf/tomcat/trunk/java/org/apache/tomcat/util/http/parser/ \
         https://svn.apache.org/repos/asf/tomcat/tc6.0.x/trunk/java/org/apache/tomcat/util/http/parser/
  svn cp https://svn.apache.org/repos/asf/tomcat/trunk/java/org/apache/tomcat/util/collections/ConcurrentCache.java \
         https://svn.apache.org/repos/asf/tomcat/tc6.0.x/trunk/java/org/apache/tomcat/util/collections/ConcurrentCache.java
  http://people.apache.org/~markt/patches/2013-07-31-bug52811-tc6.patch
  +1: markt, schultz, kkolinko
  -1:

* Fix issue with Manager app and other apps that use i18n in the UI when a
  request that specifies an Accept-Language of English ahead of French, Spanish
  or Japanese.
  http://svn.apache.org/r1514376
  +1: schultz, markt
  +0: kkolinko: 1) Code in Tomcat 6 differs. A patch is needed. 2) +r1521693
  -1:

* Fix errors in Commons Annotations 1.0 and add some @since markers
  http://svn.apache.org/r1521040
  +1: markt, schultz
  +1: kkolinko: +1 to all changes, except this one:
     I think @Target change for @DenyAll is wrong.
     Looking at Geronimo, @DenyAll has "@Target({ElementType.METHOD})" in CA 1.0 there.
     It is "@Target({ElementType.TYPE, ElementType.METHOD})" starting with CA 1.1.
    markt:
     The CA 1.0 spec section 2.11 is explicit that DenyAll is permitted on
     classes. Geronimo and whatever source was used generate the official Java
     EE 5 Javadoc are wrong.
    kkolinko:
     Discussion ("Re: r1521817"): http://tomcat.markmail.org/thread/zt6qng5bivbvrh43
     OK, let's go with it.
  -1:

* Better adherence to RFC2616 for content-length headers.
  http://people.apache.org/~markt/patches/2013-09-11-tc6-content-length.patch
  +1: markt
  +0: schultz: I don't see anywhere in RFC2616 that suggests that multiple
               Content-Length headers yields an invalid request. Another option
               for response code in this case might be 411 Length Required.
               There are some conditions under which Content-Type "RFC MUST" be
               ignored, and I don't see those cases in any of the *Processor
               classes.
      markt:   RFC2616 states that multiple headers of the same name may be
               merged in to a single, multi-valued header without any change in
               meaning. Content-Length is clearly defined as a single value
               header. If multiple values are not permitted then neither are
               multiple headers.
  -1:

* Add support for limiting the size of chunk extensions when using chunked
  encoding.
  http://people.apache.org/~markt/patches/2013-09-11-tc6-chunk-extensions.patch
  +1: markt, kkolinko
  -1:

* Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=55749
  Improve the error message when SSLEngine is disabled in AprLifecycleListener
  and SSL is configured for an APR/native connector.
  http://people.apache.org/~markt/patches/2013-11-12-bug55749-tc6.patch
  +1: markt, kkolinko
  -1:

* Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=55759
  Update the Eclipse compiler to 4.3.1
  http://svn.apache.org/viewvc?view=revision&revision=1539953
  +1: markt
  -1:


PATCHES/ISSUES THAT ARE STALLED

* Backport JSP unloading patch (BZ48358).
  The patch has substantially changed since the original version.
  Original revisions are: 937787, 1028377, 1028389, 1028396, 1028861, 1028862, 1028863,
  1028935, 1028939, 1028940, 1028944, 1028950, 1030014, 1030037
  Combined TC 6 patch:
  http://people.apache.org/~rjung/patches/BZ48358-JSP_Unloading-TC6_20101118.patch
  +1: rjung
  -0: markt - http://markmail.org/thread/777be426ulcfmdd3 suggests there may be
              a memory leak in this code somewhere. I'd like to get to the
              bottom of that before porting this
      rjung:  I started a discussion about JSPs and memory on the dev list.
              The updated patch fixes a race condition.
              We can stall this item until we get some feedback about 7.0.5.
      markt - r1172614 needs to be included in this proposal. With that patch,
              my testing shows that the unloading works as designed
      kkolinko - r1428358 (r1428355) is needed - a fix for BZ 54260.
  -1:
