================================================================================
  Licensed to the Apache Software Foundation (ASF) under one or more
  contributor license agreements.  See the NOTICE file distributed with
  this work for additional information regarding copyright ownership.
  The ASF licenses this file to You under the Apache License, Version 2.0
  (the "License"); you may not use this file except in compliance with
  the License.  You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

  Unless required by applicable law or agreed to in writing, software
  distributed under the License is distributed on an "AS IS" BASIS,
  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  See the License for the specific language governing permissions and
  limitations under the License.
================================================================================

$Id$

                         =================================
                         Apache Tomcat 6.0 Patch Proposals
                         =================================


RELEASE SHOWSTOPPERS:


PATCHES ACCEPTED TO BACKPORT:
  [ start all new proposals below, under PATCHES PROPOSED. ]

PATCHES PROPOSED TO BACKPORT:
  [ New proposals should be added at the end of the list ]

* Fix the maven stuff for the maven repo.
  Before it does't find tomcat-juli.jar and the remoteRepository seems broken .
  http://people.apache.org/~jfclere/patches/maven.patch.100711
  +1: jfclere
  -1: fhanik - easier to pass in the root path (lib/bin) to the macro instead of hacking around it
               if we remove the SCP auto feature, then there should be something to replace it with
               (http://ant.apache.org/manual/OptionalTasks/scp.html)
  +1: kkolinko: +1 for the updated patch (maven.patch.100711)
      I still think that it is not so good to remove the old code of <remoteRepository/>,
      because it ignores ${maven.repo.url} parameter provided by deploy-snapshot,
      deploy-staging and deploy-release targets. Maybe leave old code as a comment
      and fix it later if needed? I think that actually nobody besides the release manager
      uses this, so I am letting this pass.

* Expose the new WebappLoader flag in the VirtualWebappLoader,
  but allow alternative name searchVirtualFirst to make it
  consistent with the "virtual" terminology.
  Now you can decide, whether the virtual paths will
  be searched before the webapp or after it.
  If searched before, external resources take precendence
  over internal ones. Before that change one couldn't overwrite
  resources already present in the webapp.
  http://svn.apache.org/viewvc?view=revision&revision=936825
  http://people.apache.org/~rjung/patches/2010-05-14-loader-backport-r936825.patch
  +1: rjung, funkman
  -1:
  -0: kkolinko: The patch itself is OK, but I think having a synonym will
   cause confusion. I'd prefer not to invent a new name, but mention the
   one that we already have when documenting virtualClasspath.

* Fix path parameter handling. Currently the following URL fails with a 404:
  http://localhost:8080/examples/jsp/snp;x=y/snoop.jsp
  http://people.apache.org/~kkolinko/patches/2010-11-17_tc6_path-params.patch
  +1: kkolinko, markt
  -1:

   kkolinko: The old parseSessionId() method calls "clearRequestedSessionURL(request);"
     when there is no sessionid in the path. The new code does not do that. Was that
     call needed? It looks that it was not needed, but I might miss something.

   kkolinko: Discussed in Re:r1005192 thread on dev@


* Backport JSP unloading patch (BZ48358).
  The patch has substantially changed since the original version.
  Original revisions are: 937787, 1028377, 1028389, 1028396, 1028861, 1028862, 1028863,
  1028935, 1028939, 1028940, 1028944, 1028950, 1030014, 1030037
  Combined TC 6 patch:
  http://people.apache.org/~rjung/patches/BZ48358-JSP_Unloading-TC6_20101118.patch
  +1: rjung
  -0: markt - http://markmail.org/thread/777be426ulcfmdd3 suggests there may be
              a memory leak in this code somewhere. I'd like to get to the
              bottom of that before porting this
      rjung:  I started a discussion about JSPs and memory on the dev list.
              The updated patch fixes a race condition.
              We can stall this item until we get some feedback about 7.0.5.
  -1:

* Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=50726
  Ensure that the use of the genStringAsCharArray does not result in String
  constants that are too long for valid Java code.
  http://svn.apache.org/viewvc?rev=1070139&view=rev
  +1: markt, kkolinko
  -1:

* Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=50771
  Ensure HttpServletRequest#getAuthType() returns the name of the authentication scheme 
  if request has already been authenticated.
  http://svn.apache.org/viewvc?view=revision&revision=1070409
  https://issues.apache.org/bugzilla/attachment.cgi?id=26649 (patch against tc6.0)
  +1: kfujino, markt
  -1:

* Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=48863
  Provide an warning if there is a problem with a class path entry but use debug
  level logging if it is expected due to catalina home/base split
  http://people.apache.org/~kkolinko/patches/2011-03-02_tc6_48863.patch
  +1: kkolinko, markt
  -1:

* Fix possible threading issue in JSP compilation when development mode is
  enabled
  http://svn.apache.org/viewvc?rev=1078409&view=rev
  +1: markt, kfujino
  -1:

* Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=48208
  Provide an option to specify a custom trust manager
  https://issues.apache.org/bugzilla/attachment.cgi?id=26732
  Based on a patch by Luciana Moreira.
  +1: markt
  +1: kkolinko: if a typo in the code is corrected:
    s/get("trustManageClassName")/get("trustManagerClassName")/
  -1:

* Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=50854
  Allow shared manager app when running under a security manager
  https://issues.apache.org/bugzilla/attachment.cgi?id=26758
  +1: markt, kkolinko
  -1:

* Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=50887
  Enable the provider to be configured when generating SSL certs
  Based on a patch by pknopp
  https://issues.apache.org/bugzilla/attachment.cgi?id=26765
  +1: markt, kkolinko
  -1:

* Add additional configuration options to the DIGEST authenticator
  http://people.apache.org/~markt/patches/2011-04-01-digest-tc6.patch
  +1: markt
  -1:

* Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=47880
  Clarify error messages in *.sh files to mention that if a script is not
  found it might be because execute permission is needed.
  http://svn.apache.org/viewvc?rev=1088179&view=rev
  +1: kkolinko, markt
  -1:

* Update download paths in build.properties.default:
  Use maven2 repository, because servletapi-2.3 disappeared from the maven1
  one. These downloads are needed when building extras.
  It is backport of r1072962
  http://people.apache.org/~kkolinko/patches/2011-04-03_tc6_maven2.patch
  +1: kkolinko, markt
  -1:

* Backport exception logging from revision 1090022
  http://svn.apache.org/viewvc?view=revision&revision=1090022
  +1: schultz
  +1: kkolinko: +1, but I think it is better to combine this with r1073393
      (http://markmail.org/message/vkao3gcwe2w63jxj)
  -1:

* Add StuckThreadDetectionValve
  https://github.com/sylvainlaurent/tomcat60/commit/252334f958877221ecb2dc64ee0fd12bb77e360b
  +1: slaurent
  -1:

* Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=51042
  Don't notify session creation listeners when changing session ID on
  authentication
  http://svn.apache.org/viewvc?view=revision&revision=1094069
  +1: markt
  -1:

* Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=51073
  Throw an exception and do not start the APR connector if it is configured for
  SSL and an invalid value is provided for SSLProtocol.
  http://svn.apache.org/viewvc?view=revision&revision=1094089
  +1: markt, kkolinko
  -1: 

* Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=51147
  Fix deploy for HTML Manager app that was broken when CSRF prevention was added
  Patch provided by Alexis Hassler.
  https://issues.apache.org/bugzilla/attachment.cgi?id=26957&action=diff
  +1: markt, kkolinko
  -1: 

* Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=51119
  Add JAAS authentication support to the JmxRemoteLifecycleListener
  Patch provided by Neil Laurance
  http://svn.apache.org/viewvc?rev=1099586&view=rev
  +1: markt, kkolinko
  -1: 

* Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=47371
  Correctly coerce the empty string to zero when used as an operand in EL
  arithmetic.
  Patch provided by gbt.
  http://svn.apache.org/viewvc?rev=1099789&view=rev
  +1: markt, kkolinko
  -1: 

* Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=51156
  Expose session expiration option for apps defined in server.xml 
  http://svn.apache.org/viewvc?rev=1100145&view=rev
  +1: markt, kkolinko
  -1: 

* Fix SSLValve so it returns key size as an Integer rather than a String
  http://svn.apache.org/viewvc?rev=1100822&view=rev
  +1: markt, kkolinko
  -1: 

* Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=51162
  NPE protection
  http://svn.apache.org/viewvc?view=revision&revision=943112
  +1: markt
  -1: 
